<!doctype html>

    #parse("./head/header.vm")
    #parse("./head/sidebar.vm")
    #parse("./head/navbar.vm")
<link rel="stylesheet" href="public/assets/processbar/css/ystep.css" type="text/css" />
<!-- 引入jquery -->
<script type="text/javascript" src="public/assets/processbar/js/jquery.min.js"></script>
<!-- 引入ystep插件 -->
<script type="text/javascript" src="public/assets/processbar/js/ystep.js"></script>
<script src="public/assets/js/demo.js"></script>
<script src="public/assets/js/bootstrap-notify.js"></script>
<script type="text/javascript" src="public/assets/js/publishProcess.js"></script>

<script>
    nebula.publish.process.main();
</script>
<div id="loading-status" style="display: none;z-index: 100;position: fixed;margin:auto;left:0;right:0;top:0;bottom:0;width:200px;height:150px;"><img src="public/assets/img/loading.gif"></div>

<div class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card card-plain">
                    <div class="header">
                        发布单详情
                        <hr/>
                    </div>
                    <div class="content table-responsive table-full-width">
                        <table class="table table-hover table-striped">
                            <tbody>
                            <tr>
                                <td>
                                    <label>发布产品：</label>
##                                    <label>运价2014</label>
                                    <label>$!{Event.publishProductName}</label>
                                    <input id="eventId" style="display:none" type="text" value=$!{Event.id}>
##                                    <input id="actionGroup" style="display:none" type="text" value=$!{actionGroup}>
##                                    <input id="whichStep" style="display:none" type="text" value=$!{whichStep}>
##                                    <input id="actionState" style="display:none" type="text" value=$!{actionState}>
                                </td>
                                <td>
                                    <label>发布模块：</label>
                                    <label>二次发布</label>
                                </td>
                                <td>
                                    <label>发布环境：</label>
                                    <label>$!{Event.publishEnv}</label>
                                </td>
                                <td>
                                    <label>发布类型：</label>
                                    <label>发布/回滚</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>发布状态：</label>
                                    <label>发布中</label>
                                </td>
                                <td>
                                    <label>发布结果：</label>
                                    <label>$!{Event.isSuccessPublish}</label>
                                </td>
                                <td>
                                    <label>发布分批：</label>
                                    <label>是/否</label>
                                </td>
                                <td>
                                    <label>发布人：</label>
                                    <label>$!{Event.submitEmpId}</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>发布批次：</label>
                                    <label>当前1/分一批</label>
                                </td>
                                <td>
                                    <label>发布进度：</label>
                                    <label>完成0/总数1</label>
                                </td>
                                <td>
                                    <label>发布时间：</label>
                                    <label>$!{Event.publishDatetime}</label>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="card card-plain">
                    <div class="header">
                        发布的机器列表
                    </div>
                    <hr/>
                    <div>
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>模块</th>
                                <th>主机名</th>
                                <th>环境</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tbody>
                        #foreach($module in ${Event.publishModules})
                            #foreach($host in ${module.publishHosts})
                             <tr>
                                 <td>$!{module.publishModuleName}</td>
                                 <td>$!{host.passPublishHostName}</td>
                                 <td></td>
                             </tr>
                            #end
                        #end
##                            <tr>
##                                <td>P_main1</td>
##                                <td>测试</td>
##                            </tr>
##                            <tr>
##                                <td>P_main2</td>
##                                <td>测试</td>
##                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="card card-plain">
                    <div class="header">发布操作</div>
                    <hr/>
                    <div class="content">
                        <button type="button" id="btn1" class="btn btn-default" onclick="nebula.publish.process.preMasterPublish()">发布准备</button>
                        <button type="button" id="btn2" class="btn btn-default" onclick="nebula.publish.process.preMinionPublish()">启动预发布</button>
                        <button type="button" id="btn3" class="btn btn-default" onclick="nebula.publish.process.publishReal()">启动正式发布</button>
                        <button type="button" id="btn4" class="btn btn-default">我要回滚</button>
                    </div>
            </div>
            </div>
            <div id="etc_edit" class="col-md-12">
                <div id="step1" class="card card-plain">
                    <div class="header">发布准备</div>
                    <hr/>
                    <div id="processbar1" class="ystep4"></div>
                    <div id="etc_btns" style="margin-top: 30px"></div>
                </div>
            </div>
            <div class="col-md-12">
                <div id="step2" class="card card-plain">
                    <div class="header">启动预发布</div>
                    <hr/>
##                    <div class="content">
##                        <button type="button" class="btn btn-default">创建发布目录</button>
##                        <button type="button" class="btn btn-default">复制原始文件</button>
##                        <button type="button" class="btn btn-default">发布war/etc</button>
##                        <button type="button" class="btn btn-default">预发布完成</button>
##                    </div>
                    <div id="processbar2" class="ystep4"></div>
            </div>
                </div>
            <div class="col-md-12">
                <div id="step3" class="card card-plain">
                    <div class="header">启动正式发布</div>
                    <hr/>
                ##                    <div class="content">
                ##                        <button type="button" class="btn btn-default">停止tomcat</button>
                ##                        <button type="button" class="btn btn-default">删除ln</button>
                ##                        <button type="button" class="btn btn-default">创建ln</button>
                ##                        <button type="button" class="btn btn-default">启动tomcat</button>
                ##                        <button type="button" class="btn btn-default">正式发布完成</button>
                ##                    </div>
                    <div id="processbar3" class="ystep4"></div>
                </div>
            </div>
            <div class="col-md-12">
                <div id="step4" class="card card-plain">
                    <div class="header">启动回滚</div>
                    <hr/>
##                    <div class="content">
##                        <button type="button" class="btn btn-default">停止tomcat</button>
##                        <button type="button" class="btn btn-default">删除ln</button>
##                        <button type="button" class="btn btn-default">创建ln</button>
##                        <button type="button" class="btn btn-default">启动tomcat</button>
##                        <button type="button" class="btn btn-default">回滚完成</button>
##                    </div>
                    <div id="processbar4" class="ystep4"></div>
                </div>
            </div>
            <div id="false_btn"></div>
        </div>
    </div>
</div>


<<<<<<< HEAD:nebula-web/src/main/webapp/WEB-INF/pages/publishProcess.vm

#parse("head/footer.vm")
=======
#parse("./head/footer.vm")
>>>>>>> origin/master:nebula-web/src/main/webapp/WEB-INF/pages/event/publishProcess.vm
